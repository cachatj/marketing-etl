from dg_db.db_write import write_countries, write_skews


def populate_accounts():

    countries = [
        ("Germany", "DE", "Central", "Gat"),
        ("Austria", "AT", "Central", "Gat"),
        ("Switzerland", "CH", "Central", "None"),
        ("France", "FR", "South", "None"),
        ("Italy", "IT", "South", "None"),
        ("Spain", "ES", "South", "Iberia"),
        ("Portugal", "PT", "South", "Iberia"),
        ("Denmark", "DK", "North", "None"),
        ("Norway", "NO", "North", "None"),
        ("Sweden", "SE", "North", "None"),
        ("Finland", "FI", "North", "None"),
        ("Netherlands", "NL", "North", "Benelux"),
        ("Belgium", "BE", "North", "Benelux"),
        ("UK", "UK", "UKI", "None"),
        ("Ireland", "IE", "UKI", "None"),
    ]

    write_countries(countries)


def populate_skews():

    records_to_insert = [
        ("UK", 492693, 2458665, 0.20, 0.02, 0.1, 0.08, 0.08, 0.08, 0.07, 0.07,
         0.07, 0.07, 0.07, 0.1, 0.08, 0.08, 0.03),
        ("IE", 51965, 409777, 0.13, 0.02, 0.1, 0.08, 0.08, 0.08, 0.07, 0.07,
         0.07, 0.07, 0.07, 0.1, 0.08, 0.08, 0.03),
        ("DE", 729221, 3698601, 0.20, 0.03, 0.07, 0.07, 0.07, 0.08, 0.08, 0.07,
         0.08, 0.08, 0.12, 0.08, 0.08, 0.08, 0.04),
        ("AT", 111815, 821338, 0.14, 0.03, 0.07, 0.07, 0.07, 0.08, 0.08, 0.07,
         0.08, 0.08, 0.12, 0.08, 0.08, 0.08, 0.04),
        ("CH", 157896, 1044068, 0.15, 0.03, 0.07, 0.07, 0.07, 0.08, 0.08, 0.07,
         0.08, 0.08, 0.12, 0.08, 0.08, 0.08, 0.04),
        ("FR", 230684, 1120651, 0.20, 0.02, 0.06, 0.07, 0.09, 0.09, 0.09, 0.11,
         0.07, 0.11, 0.06, 0.06, 0.06, 0.07, 0.03),
        ("ES", 95035, 545993, 0.17, 0.06, 0.06, 0.06, 0.07, 0.08, 0.08, 0.08,
         0.08, 0.08, 0.09, 0.08, 0.08, 0.08, 0.04),
        ("IT", 127896, 816425, 0.16, 0.03, 0.07, 0.07, 0.08, 0.08, 0.08, 0.09,
         0.07, 0.07, 0.08, 0.08, 0.08, 0.08, 0.04),
        ("PT", 16885, 60524, 0.27, 0.05, 0.06, 0.06, 0.07, 0.08, 0.08, 0.09,
         0.07, 0.09, 0.08, 0.08, 0.08, 0.08, 0.03),
        ("NO", 26584, 150431, 0.18, 0.02, 0.05, 0.07, 0.08, 0.07, 0.08, 0.13,
         0.08, 0.1, 0.08, 0.08, 0.08, 0.08, 0.04),
        ("SE", 44339, 243477, 0.18, 0.02, 0.05, 0.07, 0.08, 0.07, 0.08, 0.13,
         0.08, 0.1, 0.08, 0.08, 0.08, 0.08, 0.04),
        ("FI", 23039, 133146, 0.17, 0.02, 0.05, 0.07, 0.08, 0.07, 0.08, 0.13,
         0.08, 0.1, 0.08, 0.08, 0.08, 0.08, 0.04),
        ("DK", 83330, 553985, 0.15, 0.02, 0.05, 0.07, 0.08, 0.07, 0.08, 0.13,
         0.08, 0.1, 0.08, 0.08, 0.08, 0.08, 0.04),
        ("NL", 110166, 604416, 0.18, 0.02, 0.05, 0.07, 0.08, 0.07, 0.08, 0.12,
         0.08, 0.09, 0.08, 0.08, 0.08, 0.08, 0.03),
        ("BE", 73444, 450679, 0.16, 0.02, 0.05, 0.07, 0.08, 0.07, 0.08, 0.12,
         0.08, 0.09, 0.08, 0.08, 0.08, 0.08, 0.03)
    ]

    q4_skews = []

    for row in records_to_insert:
        skew_range = range(4, 18)
        for n, week in enumerate(skew_range):
            q4_skews.append((row[0], 4, n + 1, row[1] * row[week], row[2] * row[week], row[3]))

    print(q4_skews)
    write_skews(q4_skews)